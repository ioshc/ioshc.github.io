<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    

    <title>iOS代码规范 | </title>
    <meta name="author" content="John Doe">
    
    <meta name="description" content="一. XCode设置
使用空格而不是制表符 Tab，不要在工程里使用 Tab 键，使用空格来进行缩进。 在 Xcode &amp;gt; Preferences &amp;gt; Text Editing 将 Tab 和自动缩进都设置为 4 个空格。  
同样的，在 Xcode &amp;gt; Preferences &amp;">
    
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta property="og:title" content="iOS代码规范"/>
    <meta property="og:site_name" content="黄聪的Blog"/>

    
    <meta property="og:image" content="undefined"/>
    

    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="alternate" href="/atom.xml" title="黄聪的Blog" type="application/atom+xml">
    <link rel="stylesheet" href="/css/lib/materialize.min.css">
    <link rel="stylesheet" href="/css/lib/font-awesome.min.css">
    <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">

    
        <link rel="stylesheet" href="/css/lib/prettify-tomorrow-night-eighties.css" type="text/css">
    
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
</head>


<body>
    <img src="/weixin_favicon.png" style="position: absolute; left: -9999px; opacity: 0; filter: alpha(opacity=0);">

    <nav class="indigo">
    <div class="nav-wrapper">
        <a href="#" data-activates="main-menu" class="button-collapse">
            <i class="fa fa-navicon"></i>
        </a>
        <div class="">
            <a href="/" class="brand-logo hide-on-med-and-down">黄聪的Blog</a>
            <ul class="right hide-on-med-and-down">
                
                    <li>
                        <a class="menu-home " href="/" >
                            <i class="fa fa-home "></i>
                            
                            首页
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-archive " href="/archives" >
                            <i class="fa fa-archive "></i>
                            
                            归档
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-category category-menu" href="javascript:;" data-activates="category-menu" >
                            <i class="fa fa-bookmark "></i>
                            
                            分类
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-reading " href="/reading" >
                            <i class="fa fa-book "></i>
                            
                            读书
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-about " href="/about" >
                            <i class="fa fa-user "></i>
                            
                            关于
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-search modal-trigger " href="#search" >
                            <i class="fa fa-search "></i>
                            
                            搜索
                        </a>
                    </li>
                
            </ul>
            <div>
    <ul class="side-nav indigo darken-1" id="main-menu">
        
        <li class="side-user">
            <div class="row">
                <div class="col s4 no-padding">
                    <img class="avatar-image circle responsive-img" src="http://ww2.sinaimg.cn/small/74990035jw1f1rjkd681bj20rs0rsdhg.jpg" alt="User Avatar">
                </div>
                <div class="info col s8 valign-wrapper no-padding">
                    <div class="valign">
                        <p class="name">黄聪</p>
                        <p class="desc">Web前端/iOS/Flutter/js</p>
                    </div>
                </div>
            </div>
        </li>
        

        
            <li class="no-padding">
                <a class="waves-effect menu-home " href="/" >
                    <i class="fa fa-home "></i>
                    
                    首页
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-archive " href="/archives" >
                    <i class="fa fa-archive "></i>
                    
                    归档
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-category category-menu" href="javascript:;" data-activates="category-menu" >
                    <i class="fa fa-bookmark "></i>
                    
                    分类
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-reading " href="/reading" >
                    <i class="fa fa-book "></i>
                    
                    读书
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-about " href="/about" >
                    <i class="fa fa-user "></i>
                    
                    关于
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-search modal-trigger " href="#search" >
                    <i class="fa fa-search "></i>
                    
                    搜索
                </a>
            </li>
        
    </ul>

    <ul class="side-nav indigo darken-1" id="category-menu">
    

            

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/编辑器/">
                    编辑器 <span class="right">1 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/iOS/">
                    iOS <span class="right">1 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/Hello-World/">
                    Hello-World <span class="right">1 篇</span></a>
                </a>
            </li>

        

    </ul>
</div>

        </div>
    </div>
</nav>

<div id="search" class="modal search-modal">
    <div class="row">
        <div class="input-field col s12">
              <input id="search-input" type="text">
              <label for="search-input">搜索</label>
        </div>

    </div>
    <div id="search-result" class="search-result col s12">

    </div>
</div>


    <main>
        <div class="container main-container">
    <nav class="page-nav hide-on-small-only">
    <div class="nav-wrapper indigo">
        <span class="breadcrumb">当前位置（分类目录）</span>
        
            
    
    
    <a class="breadcrumb" href="/categories/iOS/">iOS</a>


        

        
    </div>
</nav>

<article>
    <div class="card">
        <div class="card-content">
            

            <div class="article-title">
                
    
        <h1>iOS代码规范</h1>
    


            </div>
            <time class="indigo-link-context" datetime="2017-07-25T09:49:21.000Z"><a href="/2017/07/25/iOS代码规范/">2017-07-25</a></time>

            <span id="busuanzi_container_page_pv" class="read-times-container">
    <i class="fa fa-eye"></i>
    <span id="busuanzi_value_page_pv"></span>
</span>

            
    <div class="tags-row">
        
            <a href="/tags/iOS/" class="chip green accent-4">iOS</a>
        
            <a href="/tags/代码规范/" class="chip green accent-4">代码规范</a>
        
    </div>


            <div class="toc indigo-link-context hide-on-med-and-down">
    <ol class="section table-of-contents"><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#一-XCode设置"><span class="section table-of-contents-text">一. XCode设置</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#二-整体风格："><span class="section table-of-contents-text">二.整体风格：</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#宏定义"><span class="section table-of-contents-text">宏定义</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#运算相关"><span class="section table-of-contents-text">运算相关</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#语法糖"><span class="section table-of-contents-text">语法糖</span></a></li></ol></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#三-变量相关："><span class="section table-of-contents-text">三.变量相关：</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#四-函数相关："><span class="section table-of-contents-text">四.函数相关：</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#五-UI布局相关："><span class="section table-of-contents-text">五. UI布局相关：</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#六-类，协议相关："><span class="section table-of-contents-text">六. 类，协议相关：</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#七-Block："><span class="section table-of-contents-text">七. Block：</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#八-单词简写"><span class="section table-of-contents-text">八. 单词简写</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#九-注释"><span class="section table-of-contents-text">九. 注释</span></a></li></ol>
</div>


            <div class="entry indigo-link-context">
                <h2 id="一-XCode设置"><a href="#一-XCode设置" class="headerlink" title="一. XCode设置"></a>一. XCode设置</h2><ol>
<li>使用空格而不是制表符 <code>Tab</code>，不要在工程里使用 <code>Tab</code> 键，使用空格来进行缩进。<br> 在 <code>Xcode &gt; Preferences &gt; Text Editing</code> 将 <code>Tab</code> 和自动缩进都设置为 4 个空格。  </li>
<li>同样的，在 <code>Xcode &gt; Preferences &gt; Text Editing &gt; Page guide at column</code>: 中将最大行长设置为 100 ，过长的一行代码将会导致可读性问题。</li>
</ol>
<h2 id="二-整体风格："><a href="#二-整体风格：" class="headerlink" title="二.整体风格："></a>二.整体风格：</h2><ol>
<li>前缀：解决<code>OC</code>没有命名空间的问题。命名类、协议、常量、枚举、宏定义和<code>typedef</code>结构体时使用前缀</li>
<li>命名采用英文单词或其组合，采用大小驼峰命名法，应直观可拼读，最好望文知义，切忌使用汉语拼音来命名</li>
<li>禁止使用连续的下划线（<code>variable_name</code> 与 <code>ariable__name</code> 很难区分）</li>
<li><p>通知常用于在模块间传递消息，所以通知要尽可能地表示出发生的事件，</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">通知的命名范式是：</div><div class="line"></div><div class="line">[ 触发通知的类名 ] + [Did | Will] + [ 动作 ] + Notification</div><div class="line">UIApplicationDidEnterBackgroundNotification</div><div class="line">UIApplicationWillEnterForegroundNotification</div></pre></td></tr></table></figure>
</li>
<li><p><code>if</code>条件语句只有一行代码，不得省略<code>{}</code>，只有当条件语句和执行代码一行时才能省略（参考运算第7点）</p>
</li>
<li><code>@public</code> 和 <code>@private</code> 标记符应该以一个空格来进行缩进</li>
<li>建议加载<code>xib</code>，<code>xib</code>名称用<code>NSStringFromClass()</code>，避免书写错误</li>
<li>使用第三方框架，尽量不要更改内部文件，而应该再次封装，个性定制</li>
<li>删除所有无用代码（不用的代码直接删除，而不是注释掉）</li>
<li>空白行不要留空格（代码review是会显示成红色）</li>
</ol>
<h3 id="宏定义"><a href="#宏定义" class="headerlink" title="宏定义"></a>宏定义</h3><ol>
<li>全部大写，单词间用 <code>_</code> 分隔 (<code>#define THIS_IS_AN_MACRO @&quot;THIS_IS_AN_MACRO&quot;</code>)</li>
<li>以字母 <code>k</code> 开头，后面遵循大驼峰命名 (<code>#define kWidth self.frame.size.width</code>)</li>
<li>不要使用 <code>#define</code> 宏来定义常量，因为如果使用宏定义, 一来宏可能被重定义. 二来引用不同的文件可能会导致宏的不同</li>
</ol>
<h3 id="运算相关"><a href="#运算相关" class="headerlink" title="运算相关"></a>运算相关</h3><ol>
<li>二元运算符和参数之间要有一个空格，如赋值号 <code>=</code> 左右各留一个空格</li>
<li>一元运算符和参数之间不放置空格，比如 <code>!</code>非运算符，<code>&amp;</code>按位与，<code>|</code>按位或</li>
<li>强制类型转换和参数之间不放置空格</li>
<li>浮点型变量不能用<code>==</code>或<code>！=</code>比较，无论是<code>float</code>类型还是<code>double</code>类型的变量，都有精度限制。<br> 所以一定要避免将浮点变量用<code>==</code>或<code>!=</code>与数字比较，应该转化成<code>&gt;=</code>或<code>&lt;=</code>形式</li>
<li><code>BOOL</code> 在 <code>Objective-C</code> 中被定义为 <code>signed char</code> 类型，这意味着一个 <code>BOOL</code> 类型的变量不仅仅可以表示 <code>YES(1)</code> 和 <code>NO(0)</code> 两个值，所以永远不要将 <code>BOOL</code> 类型变量直接和 <code>YES</code> 比较</li>
<li><p>判断<code>if</code>书写方式</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath</div><div class="line">&#123;</div><div class="line">	//建议这样写</div><div class="line">	if (indexPath.row == 0) return 44;</div><div class="line">	if (indexPath.row == 1) return 80;</div><div class="line">	if (indexPath.row == 2) return 50;</div><div class="line">	return 44;</div><div class="line"></div><div class="line">	//而不是</div><div class="line">	if (indexPath.row == 0) &#123;</div><div class="line">		return 44;</div><div class="line">	&#125; else if (indexPath.row == 1) &#123;</div><div class="line">        	return 80;</div><div class="line">	&#125; else if (indexPath.row == 2) &#123;</div><div class="line">        	return 50;</div><div class="line">	&#125; else &#123;</div><div class="line">	        return 44;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="语法糖"><a href="#语法糖" class="headerlink" title="语法糖"></a>语法糖</h3><ol>
<li><p>用<code>@[]</code>构建<code>NSArray</code>，用<code>@{}</code>构建<code>NSDictionary</code><br> 如果构造代码写在一行，需要在括号两端留有一个空格，使得被构造的元素于与构造语法区分开来</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">// 正确，在语法糖的 &quot;[]&quot; 或者 &quot;&#123;&#125;&quot; 两端留有空格</div><div class="line">NSArray *array = @[ [foo description], @&quot;Another String&quot;, [bar description] ];</div><div class="line">NSDictionary *dict = @&#123; NSForegroundColorAttributeName : [NSColor redColor] &#125;;</div><div class="line"></div><div class="line">// 不正确，不留有空格降低了可读性</div><div class="line">NSArray* array = @[[foo description], [bar description]];</div><div class="line">NSDictionary* dict = @&#123;NSForegroundColorAttributeName: [NSColor redColor]&#125;;</div></pre></td></tr></table></figure>
<p> 如果构造代码不写在一行内，构造元素需要使用两个空格来进行缩进，右括号 <code>]</code> 或者 <code>}</code> 写在新的一行，并且与调用语法糖那行代码的第一个非空字符对齐。<br> 构造字典时，字典的 <code>Key</code> 和 <code>Value</code> 与中间的冒号 <code>:</code> 都要留有一个空格，多行书写时，也可以将 <code>Value</code> 对齐</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">//正确，冒号&apos;:&apos;前后留有一个空格</div><div class="line">NSDictionary *option1 = @&#123;</div><div class="line">	NSFontAttributeName : [NSFont fontWithName:@&quot;Helvetica-Bold&quot; size:12],</div><div class="line">	NSForegroundColorAttributeName : fontColor</div><div class="line">&#125;;</div><div class="line"></div><div class="line">//正确，按照Value来对齐</div><div class="line">NSDictionary *option2 = @&#123;</div><div class="line">	NSFontAttributeName :            [NSFont fontWithName:@&quot;Arial&quot; size:12],</div><div class="line">	NSForegroundColorAttributeName : fontColor</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
<li><p>使用带有 <code>@</code> 符号的语法糖来生成<code>NSNumber</code> 对象能使代码更简洁：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">NSNumber *fortyTwo = @42;</div><div class="line">NSNumber *piOverTwo = @(M_PI / 2);</div><div class="line">enum &#123;</div><div class="line">	kMyEnum = 2;</div><div class="line">&#125;;</div><div class="line">NSNumber *myEnum = @(kMyEnum);</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="三-变量相关："><a href="#三-变量相关：" class="headerlink" title="三.变量相关："></a>三.变量相关：</h2><ol>
<li>类属性，临时变量采用小驼峰命名（<code>firstName</code>）；</li>
<li>指针<code>*</code>的位置，挨着变量名（<code>NSString *varName</code>）</li>
<li>局部变量不要与全局变量重名</li>
<li>成员变量使用<code>_</code>作为前缀，（<code>NSDictionary *_userInfo</code>）</li>
<li><p>使用 <code>const</code> 定义浮点型或者单个的整数型常量，如果要定义一组相关的整数常量，应该优先使用枚举</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">const CGFloat kTableViewCellHeight = 50.0f;</div><div class="line">const NSInteger kTableViewRows = 5;</div></pre></td></tr></table></figure>
</li>
<li><p>对于拥有<code>Mutable</code>子类型的对象(e.g. <code>NSString</code>, <code>NSArray</code>, <code>NSDictionary</code>)一定要定义成<code>copy</code>属性</p>
</li>
<li>如果是内部使用的属性, 那么就定义成私有的属性(定义到<code>.m</code>的<code>class extension</code>里面)</li>
<li>尽量不要暴露<code>mutable</code>类型的对象在<code>public interface</code>, 建议在<code>.h</code>定义一个<code>Inmutable</code>类型的属性, 然后在<code>.m</code>的<code>get</code>函数里面返回一个内部定义的<code>mutable</code>变量</li>
<li>尽量不要使用死值，死值每次修改的时候容易被遗忘，地方多了找起来就悲剧了。而且定义成枚举或者<code>static</code>可以让错误发生在编译阶段。另外仅仅看到一个数字，完全不知道这个数字代表的意义</li>
<li><p>如果声明的属性，只想使用的<code>get</code>方法，不使用<code>set</code>方法，并且不想让外界更改这个属性的值，那么建议在括号里面加<code>readonly</code></p>
</li>
<li><p>给属性命名时建议采用修饰+类型的方式。以免产生歧义，比如<code>title</code> (这个到底是个<code>NSString</code>还是<code>UILabel</code>?)。同样的，<code>label</code> 我知道你是个<code>UILabel</code>，但是我不知道它是用来做什么的呀？）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">//正确的命名方式为</div><div class="line">titleLabel    //表示标题的label,  是UILabel类型</div><div class="line">confirmButton //表示确认的button, 是UIButton类型</div></pre></td></tr></table></figure>
</li>
<li><p>一个类的 <code>Delegate</code> 对象通常还引用着类本身，这样很容易造成引用循环的问题，所以类的 <code>Delegate</code> 属性要设置为弱引用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@property (nonatomic, weak) id&lt;XXXX&gt; delegate;</div></pre></td></tr></table></figure>
</li>
<li><p>如果属性是<code>BOOL</code>类型，建议在括号中重写<code>get</code>方法名称，以提高可读性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@property(nonatomic,readonly,getter=isKeyWindow) BOOL keyWindow;</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="四-函数相关："><a href="#四-函数相关：" class="headerlink" title="四.函数相关："></a>四.函数相关：</h2><ol>
<li>不要使用 <code>new</code> 方法创建对象</li>
<li>在每个方法的定义前留白一行，也就是在方法和方法之间留空一行</li>
<li>避免函数有太多的参数，这样容易把参数顺序搞错，调用不方便，若较多，可把参数定义成一个结构体，把结构体的指针当成参数传入</li>
<li>参数过多时，每个参数占用一行，以冒号对齐</li>
<li>函数长度不要超过50行，小函数比大函数可读性更强。函数的参数不宜过多，零元函数最好，一元函数也不错，高于三元的函数需重构</li>
<li><code>{</code>可写在方法末尾（加空格），也可另起一行</li>
<li>私有方法在方法名前加<code>p_</code></li>
<li>使用 <code>#pragma mark -</code> 方式对类的方法进行分组</li>
<li><code>dealloc</code>函数放在最前面</li>
<li>保持公共<code>API</code>的简洁性</li>
<li>不要用点分语法来调用方法，只用来访问属性。这样是为了防止代码可读性问题</li>
<li>函数调用的格式和声明格式一样。</li>
<li><p>如果方法是为了获取对象的一个属性值，直接用属性名称来命名这个方法，注意不要添加<code>get</code>或者其他的动词前缀<br>为什么 <code>Objective-C</code> 中不适用 <code>get</code> 前缀来表示属性获取方法？因为 <code>get</code> 在 <code>Objective-C</code> 中通常只用来表示从函数指针返回值的函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">// 三个参数都是作为函数的返回值来使用的，这样的函数名可以使用 &quot;get&quot; 前缀</div><div class="line">- (void)getLineDash:(float *)pattern count:(int *)count phase:(float *)phase;</div></pre></td></tr></table></figure>
</li>
<li><p>函数命名原则（遵循<code>Apple</code>风格）：小驼峰，尽量清晰明了，采用单词全拼，冒号对齐；尽量做到不需要注释也能了解其作用<br><code>-</code> 和 <code>(void)</code> 之间加空格，方法名和第一个参数之间不留空格，参数之前的关键字要明确(<code>middleName</code>,<code>lastName</code>)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- (void)saveMyFirstName:(NSString *)firstName</div><div class="line">        	     middleName:(NSString *)middleName</div><div class="line">       		   lastName:(NSString *)lastName;</div></pre></td></tr></table></figure>
</li>
<li><p>m文件函数实现：第一个大括号换行,其他使用场景(<code>if</code> <code>while</code> <code>else</code>)等左括号跟在第一行后面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">- (void)saveMyFirstName:(NSString *)firstName</div><div class="line">	     		middleName:(NSString *)middleName</div><div class="line">	       		lastName:(NSString *)lastName</div><div class="line">&#123;</div><div class="line">	while (1) &#123;</div><div class="line">     </div><div class="line">	&#125;</div><div class="line">	if (1) &#123;</div><div class="line"></div><div class="line">	&#125; else &#123;</div><div class="line"></div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>黄金路径，使用条件语句时，左手的代码应该是”golden” 或 “happy”路径。也就是不要嵌套<code>if</code>语句，多个返回语句也是OK。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">//应该：</div><div class="line">- (void)someMethod &#123;</div><div class="line">	if (![someOther boolValue]) &#123;</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	//Do something important</div><div class="line">&#125;</div><div class="line"></div><div class="line">//不应该：</div><div class="line">- (void)someMethod &#123;</div><div class="line">	if ([someOther boolValue]) &#123;</div><div class="line">		//Do something important</div><div class="line">  	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>在继承中，凡是要求子类重写父类的方法必须先调用父类的这个方法进行初始化操作;<br>建议:父类的方法名后面加上 <code>NS_REQUIRES_SUPER</code> ; 子类重写这个方法就会自动警告提示要调用这个 <code>super</code> 方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">// 注意:父类中的方法加`NS_REQUIRES_SUPER`,子类重写才有警告提示</div><div class="line">- (void)prepare NS_REQUIRES_SUPER;</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="五-UI布局相关："><a href="#五-UI布局相关：" class="headerlink" title="五. UI布局相关："></a>五. UI布局相关：</h2><ol>
<li>尽量使用<code>Storyboard</code> + 自动布局</li>
<li>代码布局时尽量使用相对布局，比如使用子<code>View</code>在父<code>View</code>中的相对位置</li>
<li>与主题颜色相关的控件添加引用在代码中设置，方便同意替换主题色</li>
</ol>
<h2 id="六-类，协议相关："><a href="#六-类，协议相关：" class="headerlink" title="六. 类，协议相关："></a>六. 类，协议相关：</h2><ol>
<li>类采用前缀加大驼峰命名规则（<code>SSCPersonViewController</code>）;</li>
<li>协议加<code>delegate</code>或其他比较明确能看出是协议的后缀（<code>delegate</code>，<code>protocol</code>，<code>DataSource</code>等）</li>
<li>协议中的方法遵循<code>Apple</code>系统风格，参考（<code>UITableViewDelegate</code>，<code>UITableViewDataSource</code>的函数风格）</li>
<li>对外暴露的接口和属性放头文件，不暴露的放在<code>m</code>文件；</li>
<li>给分类扩充方法，建议加上前缀，同理跟分类添加属性（利用运行时），建议加前缀</li>
<li><p>一个委托方法的第一个参数是触发它的对象，第一个关键词是触发对象的类名，除非委托方法只有一个名为 <code>sender</code> 的参数：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">// 第一个关键词为触发委托的类名</div><div class="line">- (BOOL)tableView:(NSTableView *)tableView shouldSelectRow:(int)row;</div><div class="line">- (BOOL)application:(NSApplication *)sender openFile:(NSString *)filename;</div><div class="line"></div><div class="line">// 当只有一个 &quot;sender&quot; 参数时可以省略类名</div><div class="line">- (BOOL)applicationOpenUntitledFile:(NSApplication *)sender;</div><div class="line"></div><div class="line">//根据委托方法触发的时机和目的，使用 should,will,did 等关键词</div><div class="line">- (void)browserDidScroll:(NSBrowser *)sender;</div><div class="line">- (NSUndoManager *)windowWillReturnUndoManager:(NSWindow *)window; 、</div><div class="line">- (BOOL)windowShouldClose:(id)sender;</div></pre></td></tr></table></figure>
</li>
<li><p>类型标识符、代理名称、尖括号间不留空格，该规则同样适用于<code>delegate</code>申明</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">@interface AppDelegate : UIResponder &lt;UIApplicationDelegate&gt;</div><div class="line">@end</div></pre></td></tr></table></figure>
</li>
<li><p>如果类申明中包含多个    protocal    ，每个    protocal`占用一行，缩进 4 个字符</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">@interface SSCOrderViewController ()&lt;</div><div class="line">	UITableViewDelegate,</div><div class="line">	UITableViewDataSource,</div><div class="line">	SSCOrderEstimateCellDelegate</div><div class="line">&gt; &#123;</div><div class="line">	…</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="七-Block："><a href="#七-Block：" class="headerlink" title="七. Block："></a>七. Block：</h2><ol>
<li>注意必要时使用<code>WEAKSELF</code>和<code>STRONGSELF</code>，避免造成循环引用，以及野指针（常见于访问实例变量，<code>NSTimer</code>等场景）</li>
<li>较短的 <code>block</code> 可以写在一行内。</li>
<li>如果分行显示的话， <code>block</code> 的右括号 <code>}</code> 应该和调用 <code>block</code> 那行代码的第一个非空字符对齐。</li>
<li><code>block</code> 内的代码采用 4 个空格 的缩进。</li>
<li>如果 <code>block</code> 过于庞大，应该单独声明成一个变量来使用。</li>
<li><p><code>^</code> 和 <code>(</code> 之间， <code>^</code> 和 <code>{</code> 之间都没有空格，参数列表的右括号 <code>)</code> 和 <code>{</code> 之间有一个空格</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line">// 较短的 block 写在一行内</div><div class="line">[operation setCompletionBlock:^&#123; [self onOperationDone]; &#125;];</div><div class="line"></div><div class="line">// 分行书写的 block ，内部使用 4 空格缩进</div><div class="line">[operation setCompletionBlock:^&#123;</div><div class="line">	[self.delegate newDataAvailable];</div><div class="line">&#125;];</div><div class="line"></div><div class="line">// 使用 C 语言 API 调用的 block 遵循同样的书写规则</div><div class="line">dispatch_async(_fileIOQueue, ^&#123;</div><div class="line">	NSString* path = [self sessionFilePath];</div><div class="line">	if (path) &#123;</div><div class="line">	// ...</div><div class="line">	&#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">// 较长的 block 关键字可以缩进后在新行书写，注意 block 的右括号 &apos;&#125;&apos; 和调用 block 那行代码的第一个非空字符对齐</div><div class="line">[[SessionService sharedService]</div><div class="line">	loadWindowWithCompletionBlock:^(SessionWindow *window) &#123;</div><div class="line">		if (window) &#123;</div><div class="line">			[self windowDidLoad:window];</div><div class="line">		&#125; else &#123;</div><div class="line">			[self errorLoadingWindow];</div><div class="line">		&#125;</div><div class="line">	&#125;];</div><div class="line"></div><div class="line">// 较长的 block 参数列表同样可以缩进后在新行书写</div><div class="line">[[SessionService sharedService]</div><div class="line">	loadWindowWithCompletionBlock:</div><div class="line">		^(SessionWindow *window) &#123;</div><div class="line">			if (window) &#123;</div><div class="line">				[self windowDidLoad:window];</div><div class="line">			&#125; else &#123;</div><div class="line">				[self errorLoadingWindow];</div><div class="line">			&#125;</div><div class="line">	&#125;];</div><div class="line"></div><div class="line">// 庞大的 block 应该单独定义成变量使用</div><div class="line">void (^largeBlock)(void) = ^&#123;</div><div class="line">	// ...</div><div class="line">&#125;;</div><div class="line">[_operationQueue addOperationWithBlock:largeBlock];</div><div class="line"></div><div class="line">// 在一个调用中使用多个 block ，注意到他们不是像函数那样通过 &apos;:&apos; 对齐的，而是同时进行了 4 个空格的缩进</div><div class="line">[myObject doSomethingWith:arg1</div><div class="line">	firstBlock:^(Foo *a) &#123;</div><div class="line">		// ...</div><div class="line">	&#125;</div><div class="line">	secondBlock:^(Bar *b) &#123;</div><div class="line">		// ...</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="八-单词简写"><a href="#八-单词简写" class="headerlink" title="八. 单词简写"></a>八. 单词简写</h2><p>不要使用单词的简写，拼写出完整的单词：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">// 清晰</div><div class="line">destinationSelection</div><div class="line">setBackgroundColor:</div><div class="line">// 不清晰，不要使用简写</div><div class="line">destSel</div><div class="line">setBkgdColor:</div></pre></td></tr></table></figure>
<p>然而，有部分单词简写在 <code>Objective-C</code> 编码过程中是非常常用的，以至于成为了一种规范，这些简写可以在代码中直接使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">alloc == Allocate</div><div class="line">max == Maximum</div><div class="line">alt == Alternate</div><div class="line">min == Minimum</div><div class="line">app == Application</div><div class="line">msg == Message</div><div class="line">calc == Calculate</div><div class="line">nib == Interface Builder archive</div><div class="line">dealloc == Deallocate</div><div class="line">pboard == Pasteboard</div><div class="line">func == Function</div><div class="line">rect == Rectangle</div><div class="line">horiz == Horizontal</div><div class="line">Rep == Representation (used in class name such as NSBitmapImageRep).</div><div class="line">info == Information</div><div class="line">temp == Temporary</div><div class="line">init == Initialize</div><div class="line">vert == Vertical</div><div class="line">int == Integer</div><div class="line">btn == button</div><div class="line">txf == textField</div><div class="line">dict == dictionary</div></pre></td></tr></table></figure>
<h2 id="九-注释"><a href="#九-注释" class="headerlink" title="九. 注释"></a>九. 注释</h2><ol>
<li>方法头部应进行注释，列出：函数的功能、输入参数、输出参数、返回值、修改信息等</li>
<li>全局变量要有详细的注释，包括对其功能、取值范围等说明</li>
<li>定义在头文件里的接口方法、属性必须要有注释</li>
<li><p>每个文件都必须写文件注释，文件注释通常包含：文件所在模块、作者信息、历史版本信息、版权信息、文件包含的内容，作用</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">一段良好文件注释的栗子：</div><div class="line"></div><div class="line">/*******************************************************************************</div><div class="line">Copyright (C), 2011-2013, Andrew Min Chang</div><div class="line">File name: AMCCommonLib.h</div><div class="line">Author: Andrew Chang (Zhang Min)</div><div class="line">E-mail: LaplaceZhang@126.com</div><div class="line">Description:</div><div class="line">This file provide some covenient tool in calling library tools. One can easily include</div><div class="line">library headers he wants by declaring the corresponding macros.</div><div class="line">I hope this file is not only a header, but also a useful Linux library note.</div><div class="line">History:</div><div class="line">2012-??-??: On about come date around middle of Year 2012, file created as &quot;commonLib.h&quot;</div><div class="line">2012-08-20: Add shared memory library; add message queue.</div><div class="line">2012-08-21: Add socket library (local)</div><div class="line">2012-08-22: Add math library</div><div class="line">2012-08-23: Add socket library (internet)</div><div class="line">2012-08-24: Add daemon function</div><div class="line">2012-10-10: Change file name as &quot;AMCCommonLib.h&quot;</div><div class="line">2012-12-04: Add UDP support in AMC socket library</div><div class="line">2013-01-07: Add basic data type such as &quot;sint8_t&quot;</div><div class="line">2013-01-18: Add CFG_LIB_STR_NUM.</div><div class="line">2013-01-22: Add CFG_LIB_TIMER.</div><div class="line">2013-01-22: Remove CFG_LIB_DATA_TYPE because there is already AMCDataTypes.h</div><div class="line">Copyright information:</div><div class="line">This file was intended to be under GPL protocol. However, I may use this library</div><div class="line">in my work as I am an employee. And my company may require me to keep it secret.</div><div class="line">Therefore, this file is neither open source nor under GPL control.</div><div class="line">********************************************************************************/</div></pre></td></tr></table></figure>
</li>
<li><p>方法、函数、类、协议、类别的定义都需要注释，推荐采用Apple的标准注释风格，<br> 好处是可以在引用的地方<code>alt+点击</code>查看注释，非常方便</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">一些良好的注释：</div><div class="line"></div><div class="line">objective-c</div><div class="line">/**</div><div class="line"> *  Create a new preconnector to replace the old one with given mac address.</div><div class="line"> *  NOTICE: We DO NOT stop the old preconnector, so handle it by yourself.</div><div class="line"> *</div><div class="line"> *  @param type       Connect type the preconnector use.</div><div class="line"> *  @param macAddress Preconnector&apos;s mac address.</div><div class="line"> */</div><div class="line">- (void)refreshConnectorWithConnectType:(IPCConnectType)type  Mac:(NSString *)macAddress;</div><div class="line"></div><div class="line">/**</div><div class="line"> *  Stop current preconnecting when application is going to background.</div><div class="line"> */</div><div class="line">-(void)stopRunning;</div><div class="line"></div><div class="line">/**</div><div class="line"> *  Get the COPY of cloud device with a given mac address.</div><div class="line"> *</div><div class="line"> *  @param macAddress Mac address of the device.</div><div class="line"> *</div><div class="line"> *  @return Instance of IPCCloudDevice.</div><div class="line"> */</div><div class="line">-(IPCCloudDevice *)getCloudDeviceWithMac:(NSString *)macAddress;</div><div class="line"></div><div class="line">// A delegate for NSApplication to handle notifications about app</div><div class="line">// launch and shutdown. Owned by the main app controller.</div><div class="line">@interface MyAppDelegate : NSObject &#123;</div><div class="line">  ...</div><div class="line">&#125;</div><div class="line">@end</div></pre></td></tr></table></figure>
</li>
<li><p>协议、委托的注释要明确说明其被触发的条件：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/** Delegate - Sent when failed to init connection, like p2p failed. */</div><div class="line">-(void)initConnectionDidFailed:(IPCConnectHandler *)handler;</div></pre></td></tr></table></figure>
</li>
<li><p>如果在注释中要引用参数名或者方法函数名，使用 <code>||</code> 将参数或者方法括起来以避免歧义：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">objective-c</div><div class="line">// Sometimes we need |count| to be less than zero.</div><div class="line">// Remember to call |StringWithoutSpaces(&quot;foo bar baz&quot;)|</div></pre></td></tr></table></figure></li>
</ol>

                
<p class="indigo-link-context">
    <a href="/2018/07/31/markdown基本语法/" rel="next" title="markdown基本语法">
    上一篇：markdown基本语法
  </a>
</p>



<p class="indigo-link-context">
    <a href="/2017/06/02/hello-world/" rel="next" title="Hello World">
    下一篇：Hello World
  </a>
</p>


            </div>
			
        </div>
    </div>
</article>






</div>

        <div class="fixed-action-btn float-sitemap">
    <a class="btn-floating btn-large green">
      <i class="fa fa-caret-square-o-up"></i>
    </a>
    <ul>
      <li><a class="btn-return-top btn-floating waves-effect blue" title="回到顶部"><i class="fa fa-arrow-circle-o-up"></i></a></li>
      <li><a class="btn-floating waves-effect button-collapse orange"  data-activates="main-menu" title="菜单"><i class="fa fa-navicon"></i></a></li>
    </ul>
  </div>

    </main>
    <footer class="page-footer indigo darken-1">
    
    <div class="footer-container container">
        <div class="row">
            
            <div class="social-group col m4 s12">
                <h5 class="white-text">社交</h5>
                
                    <a class="social-link" href="https://github.com/ioshc" target="_blank">
                        <i class="fa fa-2x fa-github"></i>
                    </a>
                
                    <a class="social-link" href="/atom.xml" target="_blank">
                        <i class="fa fa-2x fa-rss"></i>
                    </a>
                
                
    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
    </script>
    <div class="site-visitors-container white-text">
        <span>
            <i class="fa fa-user"></i>
            <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
        </span>
        <span>&nbsp;|&nbsp;</span>
        <span>
            <i class="fa fa-eye"></i>
            <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
        </span>
    </div>


            </div>
            

            
            <div class="col m8 s12">
                <h5 class="white-text">友情链接</h5>
                
                    <a class="social-link" href="https://github.com/ioshc" target="_blank">我的Github</a>
                
                    <a class="social-link" href="https://onevcat.com/" target="_blank">王巍的Blog</a>
                
                    <a class="social-link" href="https://blog.ibireme.com/" target="_blank">唐巧的Blog</a>
                
                    <a class="social-link" href="https://blog.ibireme.com/" target="_blank">YYKit作者Blog</a>
                
                    <a class="social-link" href="http://wwhy.tech/" target="_blank">成都老刘的Blog</a>
                
            </div>
            
        </div>
    </div>
    

    <div class="footer-copyright indigo-link-context">
        <div class="container">
            © 2018 eden.com, All rights reserved.
            <p class="right" style="margin-top: 0;">本博客由 <a href="https://hexo.io">Hexo</a> 强力驱动 | 主题 <a href="https://github.com/raytaylorlin/hexo-theme-raytaylorism">raytaylorism</a></p>
        </div>
    </div>
</footer>


    <noscript>
    <div class="noscript">
        <p class="center-align">当前网速较慢或者你使用的浏览器不支持博客特定功能，请尝试刷新或换用Chrome、Firefox等现代浏览器</p>
    </div>
</noscript>
<div class="noscript">
    <p class="center-align">当前网速较慢或者你使用的浏览器不支持博客特定功能，请尝试刷新或换用Chrome、Firefox等现代浏览器</p>
</div>


<script src="/js/jquery.min.js"></script>
<script src="/js/materialize.min.js"></script>

<script>
    (function($) {
        $(document).ready(function() {
            // 隐藏禁用javascript（针对微信内置浏览器）的提示
            $('.noscript').hide();

            // 图片缩放效果
            var $imgs = $('img').not('.slider-image').not('.avatar-image').not('.carousel-image').not('.card-cover-image').not('.qrcode');

            // 给图片加上点击放大效果（materialbox插件）
            $imgs.addClass('materialboxed').each(function(i, el) {
                $(this).attr('data-caption', $(this).attr('alt') || ' ');
            }).materialbox();

            // 优化表格的显示
            $('table').each(function() {
                var $table = $(this);
                // 除去多行代码的情况
                if ($table.find('pre').length == 0) {
                    $table.addClass('responsive-table striped bordered');
                }
            });

            // 首页幻灯片
            $('.slider').slider({indicators: true, full_width: true, interval: 8000});

            $(".button-collapse").sideNav();
            $(".category-menu").sideNav();

            // 针对gallery post
            $('.carousel').carousel({full_width: true});
            $('.carousel-control.prev').click(function() {
                $('.carousel').carousel('prev');
            });
            $('.carousel-control.next').click(function() {
                $('.carousel').carousel('next');
            });

            // 文章目录
            $('article').not('.simple-article').find('h1').add('h2').add('h3').add('h4').add('h5').add('h6').scrollSpy();

            // 目录随屏幕滚动（防止目录过长越过footer）
            var $toc = $('.toc');
            var scrollTargetTop = 0;
            $(window).scroll(function() {
                var $activeLink = $toc.find('a.active.section');
                if ($(window).scrollTop() < 100) {
                    scrollTargetTop = 0;
                } else {
                    if ($activeLink[0]) {
                        scrollTargetTop = $activeLink.offset().top - $toc.offset().top;
                    }
                }
                $toc.css('top', '-' + scrollTargetTop + 'px');
            });

            // 修正文章目录的left-border颜色
            var color = $('.table-of-contents-text').css('color');
            $('.table-of-contents-link').css('border-left-color', color);

            // 针对移动端做的优化：FAB按钮点击一下收回
            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                $('.fixed-action-btn').addClass('click-to-toggle');
            }
            // 回到顶部
            $('.btn-return-top').click(function() {
                $('body, html').animate({
                    scrollTop: 0
                }, 500);
            });

            // 重置读书页面的Tab标签页的颜色
            $('li.tab a').hover(function() {
                $(this).toggleClass('text-lighten-4');
            });
            $('.indicator').addClass('green lighten-2');

            
            // 添加new标签
            $('.menu-reading, .menu-about').append('<span class="new badge pink"></span>');
            

            // 搜索功能
            $('.modal-trigger').leanModal({
                // 打开搜索框时自动聚焦
                ready: function() {
                    if ($('#search').is(":visible")) {
                        $('#search-input').focus();
                    }
                }
            });
            var searchXml = "search.xml";
            if (searchXml.length == 0) {
             	searchXml = "search.xml";
            }
            var searchPath = "/" + searchXml;
            initSearch(searchPath, 'search-input', 'search-result');
        });

        // 初始化搜索与匹配函数
        var initSearch = function(path, search_id, content_id) {
            'use strict';
            $.ajax({
                url: path,
                dataType: "xml",
                success: function(xmlResponse) {
                    // get the contents from search data
                    var datas = $("entry", xmlResponse).map(function() {
                        return {
                            title: $("title", this).text(),
                            content: $("content", this).text(),
                            url: $("url", this).text()
                        };
                    }).get();
                    var $input = document.getElementById(search_id);
                    var $resultContent = document.getElementById(content_id);
                    $input.addEventListener('input', function() {
                        var str = '<ul class=\"search-result-list\">';
                        var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                        $resultContent.innerHTML = "";
                        if (this.value.trim().length <= 0) {
                            return;
                        }
                        // perform local searching
                        datas.forEach(function(data) {
                            var isMatch = true;
                            var content_index = [];
                            var data_title = data.title.trim().toLowerCase();
                            var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                            var data_url = data.url;
                            var index_title = -1;
                            var index_content = -1;
                            var first_occur = -1;
                            // only match artiles with not empty titles and contents
                            if (data_title != '' && data_content != '') {
                                keywords.forEach(function(keyword, i) {
                                    index_title = data_title.indexOf(keyword);
                                    index_content = data_content.indexOf(keyword);
                                    if (index_title < 0 && index_content < 0) {
                                        isMatch = false;
                                    } else {
                                        if (index_content < 0) {
                                            index_content = 0;
                                        }
                                        if (i == 0) {
                                            first_occur = index_content;
                                        }
                                    }
                                });
                            }
                            // show search results
                            if (isMatch) {
                                keywords.forEach(function(keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    data_title = data_title.replace(regS, "<span class=\"search-keyword indigo lighten-2\">" + keyword + "</span>");
                                });

                                str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                                var content = data.content.trim().replace(/<[^>]+>/g, "");
                                if (first_occur >= 0) {
                                    // cut out 100 characters
                                    var start = first_occur - 20;
                                    var end = first_occur + 80;
                                    if (start < 0) {
                                        start = 0;
                                    }
                                    if (start == 0) {
                                        end = 100;
                                    }
                                    if (end > content.length) {
                                        end = content.length;
                                    }
                                    var match_content = content.substring(start, end);
                                    // highlight all keywords
                                    keywords.forEach(function(keyword) {
                                        var regS = new RegExp(keyword, "gi");
                                        match_content = match_content.replace(regS, "<span class=\"search-keyword indigo lighten-2\">" + keyword + "</span>");
                                    });

                                    str += "<p class=\"search-result\">..." + match_content + "...</p>"
                                }
                                str += "</li>";
                            }
                        });
                        str += "</ul>";
                        $resultContent.innerHTML = str;
                    });
                }
            });
        }
    })(jQuery);
</script>


<script src="/js/prettify.js"></script>
<script type="text/javascript">
    $(document).ready(function() {
        $("pre").addClass("prettyprint");
        prettyPrint();
    });
</script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>
<script type="text/javascript" async
  src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



</body>
</html>
